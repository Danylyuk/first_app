Z‡// Flash banner on poster or extensuin code
// Last edited 28.10.2009 by Alexandr Zonov

// Editable block

var ar_img	= '';
var ar_swf	= '3002505.swf';
var ar_flashver	= 8;
var ar_width	= 300;   // set any size you whant, but 240x400 is ridiculous, use poster240x400 instead
var ar_height	= 250;
var ar_img_click	= ''; // leave empty if you do not know what it is for

var ar_flash_pixel	= ''; // zeropixel if need
var ar_gif_pixel	= ''; // zeropixel if need

// End touch nothing below
function ar_px(i){return (/^\d+$/.test(i)?i+'px':i)}
function ar_p(p,v){return typeof(v) == 'undefined' ? '' : p + '=' + v}
function ar_fp(n,v){return '<param name="'+n+'" value="'+v+'">'}
function ar_flver(d,n,m,f){
	n=navigator;f='Shockwave Flash';
	if((m=n.mimeTypes)&&(m=m["application/x-shockwave-flash"])&&m.enabledPlugin&&(n=n.plugins)&&n[f]){d=n[f].description}
	else if(window.ActiveXObject){try{d=(new ActiveXObject((f+'.'+f).replace(/ /g,''))).GetVariable('$version')}catch(e){}}
	return d?d.replace(/\D+/,'').split(/\D+/)[0]:0;
}
function ar_rnd_rep(s){return s.replace(/!\[rnd\]/g,RndNum4NoCash)}
function ar_comp(s){return !s||(/^http:\/\//i).test(s)?s:CompPath+s}

if (typeof ar_bnum=='undefined') var ar_bnum = 1;

var ar_target = Target.indexOf('_top') != -1 ? '_top' : '_blank';
var ar_html = '';
ar_swf = ar_comp(ar_rnd_rep(ar_swf));
ar_img = ar_comp(ar_rnd_rep(ar_img));
var ar_flashvars = 'link1=' + escape(CgiHref + '&rleurl=')
	+ ar_p('&target', ar_target)
	+ ar_p('&ar_comppath', escape(CompPath))
	+ ar_p('&ar_bid', bid)
	+ ar_p('&ar_bt', ar_bt)
	+ ar_p('&ar_ad', ar_adid)
	+ ar_p('&ar_nid', ar_nid)
	+ ar_p('&ar_rnd', RndNum4NoCash)
	+ ar_p('&ar_ntype', ar_ntype)
	+ ar_p('&ar_sliceid', sliceid)
	+ ar_p('&ar_sid', ar_siteid);

var ar_pix = ar_flash_pixel;
if (ar_swf && ar_flver()>=ar_flashver) {
	ar_html = '<div class="adr_b"><object id="ar_flash_'+ar_bnum+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" type="application/x-shockwave-flash" width=' + ar_width + ' height=' + ar_height + '>'
    +ar_fp('movie', ar_swf)
    +ar_fp('play','true')
    +ar_fp('wmode','opaque')
    +ar_fp('flashvars',ar_flashvars)
    +ar_fp('loop','true')
    +ar_fp('quality','high')
    +ar_fp('menu','false')
    +ar_fp('allowScriptAccess','always')
    + '<embed src="' + ar_swf + '" width=' + ar_width + ' height=' + ar_height + ' flashvars="' + ar_flashvars
	+ '" allowScriptAccess=always wmode=opaque play=true loop=true quality=high menu=false type="application/x-shockwave-flash"></embed></object></div>';
}
else {
	ar_pix = ar_gif_pixel;
	if (ar_img) {
		ar_html = '<div class="adr_b"><a href="' + CgiHref + '&rleurl=' + escape(ar_img_click)
		+ '" target="' + ar_target + '"><img src="' + ar_img +'" border=0 width=' + ar_width + ' height=' + ar_height + '></a></div>';
	}
}

if(ar_pix){
	ar_pix = ar_rnd_rep(ar_pix);
	if(document.createElement&&document.body){
		var i=document.createElement('img');
		i.style.position='absolute';i.style.width=i.style.height='0px';
		i.src=ar_pix;
		document.body.insertBefore(i,document.body.firstChild);
	}
	else {new Image().src = ar_pix}
}

var ad_fr = parent.document.getElementById('ad_ph_' + ar_bnum);
if (ad_fr){
	ad_fr.style.width=ar_px(ar_width);
	ad_fr.style.height=ar_px(ar_height);
	ad_fr.innerHTML = ar_html;
	ad_fr.style.display="block";
	setTimeout("document.close();",1000);
}
else document.write(ar_html);